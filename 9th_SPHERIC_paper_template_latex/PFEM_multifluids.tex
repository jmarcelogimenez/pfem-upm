\subsection{Particular formulation for two fluids.}
The following simplifications of the general algorithm described above are considered:

\begin{itemize}
  \item $\theta=1$
  \item $p^n=0$
\end{itemize}

As the initial pressure $p^n$ and the factor $1-\theta$ are both zero, the first stage of the general formulation can be supressed and the algorithm starts with the X-IVAS step.

The Algorithm \ref{program:twofluids} presents the final algorithm to solve incompressible fluids with two differents densities

 \begin{program}[htbp]
	{\footnotesize
	\begin{enumerate}
	    \item X-IVAS Stage:
	    \begin{equation}
	      \left\{\;
	      \begin{matrix}[l]
		  \mathbf{x}^{n+1}_{p}=\mathbf{x}^{n}_{p}+ \sum_{i=1}^{N} \mathbf{v}^{n}(\mathbf{x}^{n+\frac{i}{N}}_{p}) \delta t \\
		  \widehat{\widehat{\mathbf{v}}}^{n+1}_{p}=\mathbf{v}^{n}_{p}+ \sum_{i=1}^{N} \mathbf{f}^{n} (\mathbf{x}^{n+\frac{i}{N}}_{p})  \delta t \\
		  \lambda_p^{n+1} =\lambda_p^n
	      \end{matrix}\;
	      \right.
	      \label{Step2step2fluids}
	    \end{equation}
	    \item Projection Stage:
	    \begin{equation}\label{Step3b2fluids}
	    \left\{\;
	      \begin{matrix}[l]
	      \displaystyle \widehat{\widehat{\mathbf{v}}}^{n+1}_{j}=\frac{\sum_{p} \mathbf{v}^{n+1}_{p} W(\mathbf{x}_{j}-\mathbf{x}_{p})}{\sum_{p} W(\mathbf{x}_{j}-\mathbf{x}_{p})} \\
	      \displaystyle \lambda^{n+1}_{j}=\frac{\sum_{p} \lambda^{n+1}_{p} W(\mathbf{x}_{j}-\mathbf{x}_{p})}{\sum_{p} W(\mathbf{x}_{j}-\mathbf{x}_{p})}
	      \end{matrix}\;
	      \right.
	    \end{equation}
	    \item Implicit Viscosity Stage:
	     \begin{eqnarray}\label{Step4a2fluids}
	      \displaystyle \int_{\Omega} \widehat{\mathbf{v}}^{n+1}_{j}\psi_j d\Omega =\int_{\Omega} \widehat{\widehat{\mathbf{v}}}^{n+1}_{j}\psi_j d\Omega + \theta \Delta t \int_{\Omega} \mu_j \nabla^{2}\widehat{\mathbf{v}}^{n+1}_{j} \psi_j d\Omega
	      \end{eqnarray}

	    \item Pressure-Correction Iterations: \\
	    \texttt{set} $\mathbf{v}_j^n = \widehat{\mathbf{v}}^{n+1}_{j}$ \\
	    \texttt{for k=1 to N}
	    \begin{enumerate}
	     \item Poisson Stage: 
	     \begin{eqnarray}\label{Step5a2fluids}
	      \int_{\Omega} \nabla \cdot [\frac{\Delta t}{\rho}\nabla(\delta p^{(n+\frac{k}{N})})] \phi_j d\Omega &=& \int_{\Omega} \nabla \cdot \mathbf{v}_j^{(n+\frac{k-1}{N})} \phi_j d\Omega
% 	      \\
% 	      \frac{\partial \delta p^{n+1}}{\partial n} &=& 0 \quad in \quad \Gamma_D \\
% 	      \delta p^{n+1} &=& 0 \quad in \quad \Gamma_N
	    \end{eqnarray}	    
	    \item Correction Stage:
	     \begin{equation}\label{Step5b2fluids}
	      \int_{\Omega} \psi \rho \vv_j^{(n+\frac{k}{N})} d\Omega = \int_{\Omega} \psi \rho \vv_j^{(n+\frac{k-1}{N})} d\Omega - \Delta t \ [\int_{\Omega} \psi \nabla \delta p_j^{(n+\frac{k}{N})} d\Omega + \int_{\Omega} \psi \nabla \delta {p^*}^{(n+\frac{k}{N})} d\Omega]
	    \end{equation}
	    \end{enumerate}
	  \texttt{end for}
	  \item Particle Correction Stage:
	  \begin{equation}\label{Step6b}
	  \rho_p \mathbf{v}_p^{n+1}\  = \ \rho_p \widehat{\widehat{\mathbf{v}}}_p^{n+1} + \sum_{j} \delta \mathbf{v}_j^{n+1} \psi_j(\mathbf{x}_{p}^{n+1})
	  \end{equation}
	\end{enumerate}
	\caption{- Time Step PFEM-2 two incompressible fluids.}
	\label{program:twofluids}
      }
      \end{program}
