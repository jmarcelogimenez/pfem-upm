\documentclass[review]{elsarticle}
% \documentclass[final,3p,10pt]{elsarticle}

\usepackage{lineno,hyperref}
\modulolinenumbers[5]

\journal{Journal of \LaTeX\ Templates}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{fancyheadings}
\usepackage{float}
\usepackage{afterpage}
\usepackage{subfig}
\pagestyle{fancy}
\usepackage{graphicx}
\usepackage{amsmath}

\usepackage{wasysym}

%para las tablas con footnote
\usepackage{longtable}

\newcommand{\OF}{OpenFOAM\textsuperscript{\textregistered}}
\newcommand{\FF}{Fluent\textsuperscript{\textregistered}}
\newcommand{\tauB}{\underline{\underline{\boldsymbol{\tau}}}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\xx}{\mathbf{x}}
\newcommand{\aaa}{\mathbf{a}}
\newcommand{\ww}{\mathbf{w}}
\newcommand{\gb}{\mathbf{g}}
\newcommand{\nn}{\mathbf{n}}
\newcommand{\yy}{\mathbf{y}}
\newcommand{\Mat}{Matlab{\small$^{\textregistered}$}}

%para los algoritmos
\floatstyle{ruled}
\newfloat{program}{h}{loop}
\floatname{program}{Algorithm}

%alineacion de matrices
\makeatletter
\renewcommand*\env@matrix[1][c]{\hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols #1}}
\makeatother

%evitar corte de palabras
\pretolerance=2000
\tolerance=3000

\begin{document}

\begin{frontmatter}

%\title{Applications and improvements of the PFEM (particles + finite elements) methodology to free surface flows.}
% \title{A free surface extension of semiLagrangian particle and finite element methodologies.}
% \title{Extension and validation of the PFEM methodology to free surface flows}
%\title{Extension and validation of a last generation of PFEM on free-surface flows}
\title{An efficient adaptation of the particle finite element method to free surface flows.}
\tnotetext[mytitlenote]{Fully documented templates are available in the elsarticle package on
 \href{http://www.ctan.org/tex-archive/macros/latex/contrib/elsarticle}{CTAN}.}

%% Group authors per affiliation:
% \author{Juan M. Gimenez\fnref{myfootnote}}
% \address{CIMEC, Santa Fe, Argentina}
% \author{Leo M. Gonz\'{a}lez\fnref{myfootnote}}
% \address{UPM, Madrid, Spain}
%\fntext[myfootnote]{Since 1880.}

% or include affiliations in footnotes:
\author[mymainaddress]{Juan M. Gimenez\corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{Corresponding author}
\ead{jmarcelogimenez@gmail.com}
%\ead[url]{www.elsevier.com}
\author[mysecondaryaddress]{Leo M. Gonz\'{a}lez}
\address[mymainaddress]{Centro de Investigaci\'on de M\'etodos Computacionales (CIMEC-CONICET), Santa Fe, Argentina}
\address[mysecondaryaddress]{Escuela T\'{e}cnica Superior de Ingenieros Navales, Universidad Polit\'{e}cnica de Madrid (ETSIN-UPM), Madrid, Spain}

\begin{abstract}
In this paper a new generation of the particle method known as Particle Finite Element Method (PFEM), which combines convective particle movement and fixed mesh resolution, is applied to free surface flows. This methodology, named PFEM-2, presents basically two novel steps: first, the possibility of using larger time steps compared to other similar numerical tools, showing in a wide variety of problems that shorter computational times can be achieved while the solution accuracy is maintained. Second, as surface flows is the searched topic of the paper, different improved versions of discontinuous and continuous enriched basis functions for the pressure field have been also developed in order to reconstruct the free surface without artificial diffusion or undesired numerical effects. Combining these two improvements, a variety of free surface flows have been solved in 2D and 3D cases, where the evident advantages of the improvements are remarked. The collection of problems has been carefully selected such that a wide variety of Froude numbers, density ratios and dominant dissipative cases are presented with the intention of presenting a general methodology that is not restricted to particular ranges of application.
The results of the different free-surface problems solved which include: Rayleigh-Taylor instability, sloshing problems, viscous standing waves and the dam break problem are compared to well validated numerical alternatives and experimental measurements obtaining good approximations for such complex flows.
\end{abstract}

\begin{keyword}
PFEM, PFEM-2, free surface flows, finite elements, large time-steps, enrichment
% \MSC[2010] 00-01\sep  99-00
\end{keyword}

\end{frontmatter}

\linenumbers
\fboxsep=0mm%padding thickness

\section{Introduction}\label{Intro}
\input{Intro}


\section{PFEM-2 Algorithm}\label{PFEM_Algorithm}
\input{PFEM}

\section[Free-Surface treatment]{Free-Surface flows treatment}\label{Free_surface}
\input{Free_surface}
\input{PFEM_multifluids}

% \section{Second order improvements.}\label{Second_order}
% \input{Second_order}

\section{Results}\label{FS_results}

In this section a wide range of free-surface problems, with different ratio between the densities and viscosities of the fluids involved, are solved using the PFEM-2 method and its results compared with reference ones, which include numerical results, experimental analysis and/or analytical solutions.

The first case is the widely known Rayleigh-Taylor instability, where a small perturbation must generate complex fluid structures that are well reported in literature.
This problem focuses on the capabilities of the method to deal with large time-steps. These results are compared with those obtained with a well reputed Eulerian strategy: named Volume fo Fluid (VoF), which adds limiters as a method of guaranteeing boundedness of phase-fractions, and interface compression numerical terms to keep the interface sharpen.
The second test is a sloshing problem which allows to test the behavior of the numerical strategy when different density ratios are simulated, the upcoming results are compared to well validated codes. In this test, a discussion about the enrichment strategies is presented. Next problem where the ability of the method to deal with a highly dissipative free surface flow is tested is a standing wave problem, results are compared to semi-analytical solutions of the decayment of the total energy of the system.
Finally, the last example is a direct comparison against results coming from a dam-break experiment.
This case shows that the method can solve large motions of the interfaces and splashing of waves, and keep acceptable level of accuracy when a comparison against pressure and height measurements is performed.

The main aim of this section is to show the capability of the method to treat with large Courant numbers without loss stability and without almost resign accuracy, then reasonable large time-steps are selected in each test. Previous PFEM-2 works (see \cite{Idelsohn12b}\cite{Gimenez14}) showed that the computational cost of each time-step is almost equal than traditional Eulerian solvers, and the possibility of increasing the time-step decreases the duration of the global computation without loss of accuracy. In this work, the efficient distributed-memory implementation presented in \cite{Gimenez14} is extended to the free-surface treatment and used to simulate each of next cases presented.
 
 %if the method is able to solve simulation using larger time-steps than another codes, consequently it will be faster to solve the same problem and it will obtain results with guaranteed accuracy.

\input{FS_results_RT}
\input{FS_results_Ansari}
\input{FS_results_standingwave}
\input{FS_results_DamBreak}
% \input{FS_results_Roll}


\section{Conclusions}

The second generation of the Particle Finite Element Method (PFEM-2) is a novel strategy which uses a spatial discretization based on a background mesh and a cloud of particles. The dynamics equations are solved in a Lagrangian frame, where the implicit nonlinearities of the equation are solved using the {X-IVAS} strategy. That explicit temporal integration for convective terms allows to use large time-steps, then it provides a very efficient way concerning to computing times.

In the current work, a general formulation to solve free-surface flows with pressure gradient discontinuities was presented and exhaustively tested. That algorithm, which is based on a continuous enriched space for pressure, has shown good accuracy solving a wide range of multiphase problems and keeping the advantage of the possibility of using large time-steps. Several cases with a large variety of Froude numbers, density ratios and dominant dissipative cases have been analyzed, whose results were compared with other reference softwares, semi-analytical expressions and also experimental data. In each of them, PFEM-2 has proven being accurately competitive and computationally efficient. Regarding to CPU times, they can be decreased without accuracy lost if the condensing strategy for enriched pressure degrees of freedom is used. That approach loss the generality of the formulation for any range of application, but reduces the computational cost enforcing the asseveration that, to our knowledge, nowadays PFEM-2 is the faster algorithm for solving multiphase flows.

% use section* for acknowledgement
\section*{Acknowledgment}

Authors thank to Pedro Gal\'an del Sastre (UPM-Spain), Eng. Pablo Becker (CIMNE-Spain), Dr. Norberto Nigro (CIMEC-Argentina) and Prof. Sergio Idelsohn (CIMNE-Spain and CIMEC-Argentina) for their valuable help and discussions about the method features and its implementation. Also to Dr. Santiago M\'arquez Dami\'an (CIMEC-Argentina) for its contribution in OpenFOAM simulations.

J. Gimenez gratefully acknowledges the support of the Argentinian Agencia Nacional de Promoci\'on Cient\'ifica y T\' ecnica (ANPCyT) through a doctoral grant in the FONCyT program. Also the authors thank to the program ERASMUS mundus action 2 ARCOIRIS project for financial support throught a six-month doctoral scholarship.

Other financial support was provided by CONICET, Universidad Nacional del Litoral (CAI+D Tipo II 65-333 (2009)), ANPCyT-FONCyT (grants PICT 1645 BID (2008)) and ERC Advanced Grant REALTIME project AdG-2009325.

\bibliographystyle{plain}
\bibliography{mybib}


%\section{The Elsevier article class}
%
%\paragraph{Installation} If the document class \emph{elsarticle} is not available on your computer, you can download and install the system package \emph{texlive-publishers} (Linux) or install the \LaTeX\ package \emph{elsarticle} using the package manager of your \TeX\ installation, which is typically \TeX\ Live or Mik\TeX.
%
%\paragraph{Usage} Once the package is properly installed, you can use the document class \emph{elsarticle} to create a manuscript. Please make sure that your manuscript follows the guidelines in the Guide for Authors of the relevant journal. It is not necessary to typeset your manuscript in exactly the same way as an article, unless you are submitting to a camera-ready copy (CRC) journal.
%
%\paragraph{Functionality} The Elsevier article class is based on the standard article class and supports almost all of the functionality of that class. In addition, it features commands and options to format the
%\begin{itemize}
%\item document style
%\item baselineskip
%\item front matter
%\item keywords and MSC codes
%\item theorems, definitions and proofs
%\item lables of enumerations
%\item citation style and labeling.
%\end{itemize}
%
%\section{Front matter}
%
%The author names and affiliations could be formatted in two ways:
%\begin{enumerate}[(1)]
%\item Group the authors per affiliation.
%\item Use footnotes to indicate the affiliations.
%\end{enumerate}
%See the front matter of this document for examples. You are recommended to conform your choice to the journal you are submitting to.
%
%\section{Bibliography styles}
%
%There are various bibliography styles available. You can select the style of your choice in the preamble of this document. These styles are Elsevier styles based on standard styles like Harvard and Vancouver. Please use Bib\TeX\ to generate your bibliography and include DOIs whenever available.
%
%Here are two sample references: \cite{Feynman1963118,Dirac1953888}.
%
%\section*{References}
%
%\bibliography{mybibfile}

\end{document} 